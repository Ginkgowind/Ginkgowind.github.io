<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords"><meta name="descriptioon" content=""><meta name="renderer" content="wekit"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/css/public.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/iconfont.css"><script>var _hmt = _hmt || [];(function(){var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?7b429839b56cf831028b7ac4cb9b5086";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})()</script><title>InsideUE4——GamePlay框架总结 [ Hexo ]</title><link rel="stylesheet" href="/css/partial/footer.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><link rel="stylesheet" href="/css/partial/sidebar.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head><body class="scroll"><link rel="stylesheet" href="/css/partial/header.css"><div class="header scroll"><div class="maxwidth"><div class="nav"><a id="artlist" href="/404"><i class="iconfont icon404"></i><span class="headhid">&nbsp;404</span></a><a id="artlist" href="/archives"><i class="iconfont iconarchives"></i><span class="headhid">&nbsp;Archives</span></a><a id="artlist" href="/link"><i class="iconfont iconlink"></i><span class="headhid">&nbsp;Link</span></a><a id="artlist" href="/about"><i class="iconfont iconabout"></i><span class="headhid">&nbsp;About</span></a></div><div class="search">TONG-H</div></div></div><div class="main"> <div class="maxwidth"><link rel="stylesheet" href="/css/partial/sidebar.css"><div class="scroll" id="sidebar"><div class="social"><a href="/archives" title="Home"><i class="iconfont iconHome"></i></a><a href="1813828837@qq.com" title="E-Mail"><i class="iconfont iconweibiaoti554"></i></a><a target="_blank" rel="noopener" href="https://github.com/Ginkgowind" title="GitHub"><i class="iconfont iconGitHub"></i></a></div><div class="structure category-list"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E6%80%BB%E7%BB%93"><span class="toc-number">1.</span> <span class="toc-text">个人总结</span></a></li></ol></div><div class="tags"></div></div><div class="post rightside"><div class="artititle">InsideUE4——GamePlay框架总结</div><div class="info"><i class="iconfont iconshijian"><span title="文章发布时间">2022-09-02</span></i></div><div class="postDetail"><h1 id="个人总结"><a href="#个人总结" class="headerlink" title="个人总结"></a>个人总结</h1><blockquote>
<p>为了面试口述，内容有省略，后续会完善。<br>笔者也表示Damage确实不是AActor应该管的事情。</p>
</blockquote>
<p>首先是UObject，提供了反射、GC、序列化等等属性，因为提供了很强大的这些基本属性，UObject基本是UE中一切类的起源。</p>
<p>Actor就是继承于UObject，添加了网络复制、Tick等等。Actor在UE中既包含具象化的实体，也包含一些看不到的信息、状态、规则，比如AInfo系列（GameMode、GameState这些）。所以Actor并不是自带Transform的，而是将Transform封装到了SceneComponent当做RootComponent，对外暴露出GetActorLocation这些。至于为什么要将Info继承自Actor而不是另起一套，我觉得可能是需要Tick、网络复制等等，但是Component、Damage对于Info来说又好像确实是冗余的，这里还不是很明白。</p>
<p>然后是Component，这其中也是“组合优于继承”的一种理念吧，如果什么都靠继承，那类的数量必然会相当爆炸。所以UE中的Actor就是靠各种Component组合而成。而Component也往下分为了两类，一类是有变换的SceneComponent（比如StaticMeshComponent），另一类是直接继承自ActorComponent的（比如UMovementComponent）。UE在SceneComponent这一级才提供了组件嵌套的能力，这个觉得也是合理的，毕竟组件嵌套最主要还是为了Transform的跟随。给移动组件添加嵌套能力也没啥作用，还容易让使用者产生困惑。</p>
<p>那对于游戏中大量Acotr的组织，UE是采用了多个Level组成World，每个Level管理自己内部的Acotr，这其实就是将游戏世界给细化了。同时每个Level也有自己的关卡蓝图，可以设置场景的静态属性比如重力等等。这种模式还有些别的好处，一是World管理着Level的动态加载与释放，可以节省性能；二是多个Level可以并行地编辑等等。</p>
<p>一个World可以管理多个Level，而World也不止一个，在UE中编辑器本身、预览窗口、运行后的游戏都是World，有点“平行世界”的意思，其中一个World对应一个WorldContext。World放在WorldContext来管理的，而WorldContext又是放在GameInstance来管理的。</p>
<p>然后是Pawn，Pawn继承自Actor，一些特点包括可被Controller控制、有移动组件输入的接口，默认是开启了网络复制的。从Pawn开始，就是一般游戏中玩家所直接控制的了。角色也不用多说，主要是对Pawn进行了扩展，包括骨架网格体、胶囊体组件、角色移动组件等等</p>
<p>Controller是单独抽离出来用来控制Pawn的一个类，且能够切换所控制的Pawn，PlayerState是可以存放一些玩家的数据。这三者是平级的并且一对一对一的关系，跟UE的网络关系很密切。</p>
<p>Controller又分为PlayerController和AIController。其中PlayerController直接跟玩家关联、并能够接收玩家设备的输入、提供摄像机管理等等。AIController就是提供了一些AI组件，运行行为树功能等等。</p>
<p>&amp;emsp;Controller是单独抽离出来用来控制Pawn的一个类，且能够切换所控制的Pawn，PlayerState是可以存放一些玩家的数据。这三者是平级的并且一对一对一的关系，跟UE的网络关系很密切。</p>
<p>&amp;emsp;Controller又分为PlayerController和AIController。其中PlayerController直接跟玩家关联、并能够接收玩家设备的输入、提供摄像机管理等等。AIController就是提供了一些AI组件，运行行为树功能等等。</p>
<p>然后是GameMode，GameMode主要是负责一些初始类的登记（比如默认的Pawn、PlayerController等等），以及负责游戏整体的逻辑，制定规则与玩法什么的。但是在网络游戏中，GameMode是只存在于服务端，客户端是不存在的，那为了一些数据的复制，就衍生出了GameState。这样也实现了一个游戏整体上逻辑与数据的解耦分离。此外，对于玩家控制器，客户端是只持有本地的那一个，服务端则是拥有所有的。</p>
<p>还有一个Player类，这个类也很重要，但是其功能基本都在幕后实现了，一般业务里也接触不到。而他派生出的LocalPlayer类是对应到了咱们玩游戏时的视口。</p>
<p>GameInstance在一次游戏中是唯一的，负责了引擎初始化、玩家创建、网络等等，一些全局性的配置或者比较独立的业务比如UI也可以放在这里。</p>
<p>UE也提供了GamePlayStatics这样一个静态类，来方便我们调用一些游戏内的函数（GetActorOfClass、Spawn等等）。</p>
</div></div><link rel="stylesheet" href="/css/partial/footer.css"><div class="footer"><p><span>Copyright © 2017 - 2022  </span><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn/">蜀ICP备19024124号</a></p><p><i class="iconfont iconchakan"><span>本站总访问量</span><span id="busuanzi_container_site_pv">  <span id="busuanzi_value_site_pv"></span> </span></i><i class="iconfont iconabout"><span>本站访客数</span><span id="busuanzi_container_site_uv">  <span id="busuanzi_value_site_uv"></span> </span></i></p></div></div></div><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>